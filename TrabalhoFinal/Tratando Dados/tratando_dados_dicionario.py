# -*- coding: utf-8 -*-
"""Tratando_dados_dicionario.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1lAayNoVnzCttKIKCT3KH2v95QQEXn4Cl
"""

# Carregando os pacotes
import pandas as pd
import numpy as np

pd.set_option('display.max_rows', None)

# dicionário dos dados
df = pd.read_excel('/content/dicionario_PNS_microdados_2019.xls', skiprows=1)

df.head()

# Pegando as colunas de interesse
colunas = ['Código\nda\nvariável','Unnamed: 4','Categorias','Unnamed: 6']

df = df[colunas]

# Remova as linhas com NA na coluna "tipo"
df = df.dropna(subset=['Categorias'])

# Removendo a primeira linha
df = df.drop(df.index[0])

# Renomeando as colunas
df = df.rename(columns={
    'Código\nda\nvariável': 'Codigo da variavel',
    'Unnamed: 4': 'Descricao_variavel',
    'Categorias': 'Tipo',
    'Unnamed: 6': 'Descricao_tipo'
})

df['Codigo da variavel'] = df['Codigo da variavel'].fillna(method='ffill')
df['Descricao_variavel'] = df['Descricao_variavel'].fillna(method='ffill')

df.head(5)

# Dicionário de mapeamento de unidades federativas para regiões
mapa_regioes = {
    
    # Rondonia
    '11': 'Norte',
    # Acre
    '12': 'Norte',
    #Amazonas
    '13': 'Norte',
    # Roraima
    '14': 'Norte',
    # Pará
    '15': 'Norte',
    # Amapá
    '16': 'Norte',
    #Tocantis
    '17': 'Norte',
    # Maranhao
    '21': 'Nordeste',
    # Piaui
    '22': 'Nordeste',
    #Ceará
    '23': 'Nordeste',
    # Rio Grande do Norte 
    '24': 'Nordeste',
    # Paraiba
    '25': 'Nordeste',
    # Pernambuco
    '26': 'Nordeste',
    # Alagoas
    '27': 'Nordeste',
    # Sergie
    '28': 'Nordeste',
    #Bahia
    '29': 'Nordeste',
    # Minas Gerais
    '31': 'Sudeste',
    # Espirito Santo
    '32': 'Sudeste',
    # Rio de Janero
    '33': 'Sudeste',
    # Sao Paulo
    '35': 'Sudeste',
    # Paraná
    '41': 'Sul',
    # Santa Catarina
    '42': 'Sul',
    # Rio Grande do Sul
    '43': 'Sul',
    # Mato Grosso do Sul
    '50': 'Centro-Oeste',
    # Mato Grosso
    '51': 'Centro-Oeste',
    # Goias
    '52': 'Centro-Oeste',
    # Distrito Federal
    '53': 'Centro-Oeste'
}
